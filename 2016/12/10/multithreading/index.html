<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://yoursite.com">
  <title>multithreading | Carol</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="多线程参考进程和线程区别
1.定义进程是具有一定独立功能的程序关于某个数据集合上的一次运行活动,进程是系统进行资源分配和调度的一个独立单位.
一个进程中可以包含若干个线程，它们可以利用进程所拥有的资源。在引入线程的操作系统中，通常都是把进程作为分配资源的基本单位，而把线程作为独立运行和独立调度的基本单位。线程是进程的一个实体,是CPU调度和分派的基本单位,它是比进程更小的能独立运行的基本单位.线程">
<meta property="og:type" content="article">
<meta property="og:title" content="multithreading">
<meta property="og:url" content="http://yoursite.com/2016/12/10/multithreading/index.html">
<meta property="og:site_name" content="Carol">
<meta property="og:description" content="多线程参考进程和线程区别
1.定义进程是具有一定独立功能的程序关于某个数据集合上的一次运行活动,进程是系统进行资源分配和调度的一个独立单位.
一个进程中可以包含若干个线程，它们可以利用进程所拥有的资源。在引入线程的操作系统中，通常都是把进程作为分配资源的基本单位，而把线程作为独立运行和独立调度的基本单位。线程是进程的一个实体,是CPU调度和分派的基本单位,它是比进程更小的能独立运行的基本单位.线程">
<meta property="og:updated_time" content="2016-12-18T15:11:24.411Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="multithreading">
<meta name="twitter:description" content="多线程参考进程和线程区别
1.定义进程是具有一定独立功能的程序关于某个数据集合上的一次运行活动,进程是系统进行资源分配和调度的一个独立单位.
一个进程中可以包含若干个线程，它们可以利用进程所拥有的资源。在引入线程的操作系统中，通常都是把进程作为分配资源的基本单位，而把线程作为独立运行和独立调度的基本单位。线程是进程的一个实体,是CPU调度和分派的基本单位,它是比进程更小的能独立运行的基本单位.线程">
  
    <link rel="alternative" href="/atom.xml" title="Carol" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/avatar.png">
  
  <link rel="stylesheet" href="/main.css?v=4.0.0.css">
  

</head>

<body>
  <div id="container" q-class="show:isCtnShow">
    <canvas id="anm-canvas" class="anm-canvas"></canvas>
    <div class="left-col" q-class="show:isShow">
      <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="/img/avatar.png" class="js-avatar">
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">caroltuan</a></h1>
		</hgroup>

		
		<p class="header-subtitle">Carol&#39;s blog</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">主页</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
	        
    		
    			
    			<a data-idx="0" q-on="click: openSlider(e, 'innerArchive')" href="javascript:void(0)">所有文章</a>
    			
    			
            
    			
    			<a data-idx="1" q-on="click: openSlider(e, 'friends')" href="javascript:void(0)">友链</a>
    			
    			
            
    			
    			<a data-idx="2" q-on="click: openSlider(e, 'aboutme')" href="javascript:void(0)">关于我</a>
    			
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://caroltuan.github.io/" title="github"><i class="icon-github"></i></a>
		        
					<a class="weibo" target="_blank" href="http://weibo.com/u/3908875562?refer_flag=1001030102_&is_all=1" title="weibo"><i class="icon-weibo"></i></a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col" q-class="show:isShow,hide:isShow|isFalse">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"><i class="icon-sort"></i></div>
  		<h1 class="header-author js-mobile-header hide">caroltuan</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="/img/avatar.png" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">caroltuan</h1>
			</hgroup>
			
			<p class="header-subtitle">Carol&#39;s blog</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
		        
		        	<li><a href="/archives/">所有文章</a></li>
		        
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://caroltuan.github.io/" title="github"><i class="icon-github"></i></a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/u/3908875562?refer_flag=1001030102_&is_all=1" title="weibo"><i class="icon-weibo"></i></a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div id="wrapper" class="body-wrap">
        <div class="menu-l">
          <div class="canvas-wrap">
            <canvas data-colors="#eaeaea" data-sectionHeight="100" data-contentId="js-content" id="myCanvas1" class="anm-canvas"></canvas>
          </div>
          <div id="js-content" class="content-ll">
            <article id="post-multithreading" class="article article-type-post " itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      multithreading
    </h1>
  

        <a href="/2016/12/10/multithreading/" class="archive-article-date">
  	<time datetime="2016-12-10T14:50:56.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2016-12-10</time>
</a>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="多线程"><a href="#多线程" class="headerlink" title="多线程"></a>多线程</h2><p>参考<a href="http://blog.csdn.net/yaosiming2011/article/details/44280797" target="_blank" rel="external">进程和线程区别</a></p>
<h6 id="1-定义"><a href="#1-定义" class="headerlink" title="1.定义"></a>1.定义</h6><p>进程是具有一定独立功能的程序关于某个数据集合上的一次运行活动,进程是系统进行资源分配和调度的一个独立单位.</p>
<p>一个进程中可以包含若干个线程，它们可以利用进程所拥有的资源。在引入线程的操作系统中，通常都是把进程作为分配资源的基本单位，而把线程作为独立运行和独立调度的基本单位。线程是进程的一个实体,是CPU调度和分派的基本单位,它是比进程更小的能独立运行的基本单位.线程自己基本上不拥有系统资源,只拥有一点在运行中必不可少的资源(如程序计数器,一组寄存器和栈),但是它可与同属一个进程的其他的线程共享进程所拥有的全部资源.</p>
<p>2.关系</p>
<p>一个线程可以创建和撤销另一个线程;同一个进程中的多个线程之间可以并发执行.</p>
<p>相对进程而言，线程是一个更加接近于执行体的概念，它可以与同进程中的其他线程共享数据，但拥有自己的栈空间，拥有独立的执行序列。</p>
<p>3.区别</p>
<p>进程和线程的主要差别在于它们是不同的<a href="http://lib.csdn.net/base/operatingsystem" target="_blank" rel="external">操作系统</a>资源管理方式。进程有独立的地址空间，一个进程崩溃后，在保护模式下不会对其它进程产生影响，而线程只是一个进程中的不同执行路径。线程有自己的堆栈和局部变量，但线程之间没有单独的地址空间，一个线程死掉就等于整个进程死掉，所以多进程的程序要比多线程的程序健壮，但在进程切换时，耗费资源较大，效率要差一些。<strong>但对于一些要求同时进行并且又要共享某些变量的并发操作，只能用线程，不能用进程。</strong></p>
<p><strong>1) 简而言之,一个程序至少有一个进程,一个进程至少有一个线程.</strong></p>
<p>2) 线程的划分尺度小于进程，使得多线程程序的并发性高。</p>
<p>3) 另外，进程在执行过程中拥有独立的内存单元，而多个线程共享内存，从而极大地提高了程序的运行效率。</p>
<p>4) 线程在执行过程中与进程还是有区别的。每个独立的线程有一个程序运行的入口、顺序执行序列和程序的出口。<strong>但是线程不能够独立执行，</strong>必须依存在应用程序中，由应用程序提供多个线程执行控制。</p>
<p>5) 从逻辑角度来看，多线程的意义在于一个应用程序中，有多个执行部分可以同时执行。但操作系统并没有将多个线程看做多个独立的应用，来实现进程的调度和管理以及资源分配。<strong>这就是进程和线程的重要区别。</strong></p>
<p>4.优缺点</p>
<p>线程和进程在使用上各有优缺点：线程执行开销小，但不利于资源的管理和保护；而进程正相反。同时，线程适合于在SMP机器上运行，而进程则可以跨机器迁移。</p>
<p>线程和进程一样分为五个阶段：创建、就绪、运行、阻塞、终止。</p>
<p><a href="http://blog.csdn.net/ITMagic_Jack/article/details/6196939" target="_blank" rel="external">http://blog.csdn.net/ITMagic_Jack/article/details/6196939</a></p>
<h4 id="二：在Java中实现多线程"><a href="#二：在Java中实现多线程" class="headerlink" title="二：在Java中实现多线程"></a>二：在<strong>Java</strong>中实现多线程</h4><p>继承 Thread 类，覆盖方法 run()： </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">[java] view plain copy</div><div class="line"></div><div class="line"><span class="number">1</span>.     <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FishMeThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;  </div><div class="line"></div><div class="line"><span class="number">2</span>.       </div><div class="line"></div><div class="line"><span class="number">3</span>.           <span class="keyword">int</span> count= <span class="number">1</span>, number;  </div><div class="line"></div><div class="line"><span class="number">4</span>.            </div><div class="line"></div><div class="line"><span class="number">5</span>.           <span class="function"><span class="keyword">public</span> <span class="title">FishMeThread</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;  </div><div class="line"></div><div class="line"><span class="number">6</span>.                 number = num;  </div><div class="line"></div><div class="line"><span class="number">7</span>.                 System.out.println(<span class="string">"创建线程 "</span> + number);  </div><div class="line"></div><div class="line"><span class="number">8</span>.           &#125;  </div><div class="line"></div><div class="line"><span class="number">9</span>.       </div><div class="line"></div><div class="line"><span class="number">10</span>.       <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;  </div><div class="line"></div><div class="line"><span class="number">11</span>.             <span class="keyword">while</span>(<span class="keyword">true</span>) &#123;  </div><div class="line"></div><div class="line"><span class="number">12</span>.                  System.out.println(<span class="string">"线程 "</span> + number + <span class="string">":计数 "</span> + count);  </div><div class="line"></div><div class="line"><span class="number">13</span>.                  <span class="keyword">if</span>(++count== <span class="number">6</span>) <span class="keyword">return</span>;  </div><div class="line"></div><div class="line"><span class="number">14</span>.             &#125;  </div><div class="line"></div><div class="line"><span class="number">15</span>.       &#125;  </div><div class="line"></div><div class="line"><span class="number">16</span>.   </div><div class="line"></div><div class="line"><span class="number">17</span>.       <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span> </span>&#123;  </div><div class="line"></div><div class="line"><span class="number">18</span>.             <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;  </div><div class="line"></div><div class="line"><span class="number">19</span>.                   <span class="keyword">new</span> FishMeThread(i + <span class="number">1</span>).start();  </div><div class="line"></div><div class="line"><span class="number">20</span>.             &#125;   </div><div class="line"></div><div class="line"><span class="number">21</span>.       &#125;  </div><div class="line"></div><div class="line"><span class="number">22</span>.   </div><div class="line"></div><div class="line"><span class="number">23</span>. &#125;</div></pre></td></tr></table></figure>
<pre><code>方法二：实现 Runnable 接口：  
</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">[java] view plain copy</div><div class="line"></div><div class="line"><span class="number">1</span>.     <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FishMeThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;  </div><div class="line"></div><div class="line"><span class="number">2</span>.       </div><div class="line"></div><div class="line"><span class="number">3</span>.           <span class="keyword">int</span> count= <span class="number">1</span>, number;  </div><div class="line"></div><div class="line"><span class="number">4</span>.       </div><div class="line"></div><div class="line"><span class="number">5</span>.           <span class="function"><span class="keyword">public</span> <span class="title">MyThread</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;  </div><div class="line"></div><div class="line"><span class="number">6</span>.                 number = num;  </div><div class="line"></div><div class="line"><span class="number">7</span>.                 System.out.println(<span class="string">"创建线程 "</span> + number);  </div><div class="line"></div><div class="line"><span class="number">8</span>.           &#125;  </div><div class="line"></div><div class="line"><span class="number">9</span>.       </div><div class="line"></div><div class="line"><span class="number">10</span>.       <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;  </div><div class="line"></div><div class="line"><span class="number">11</span>.             <span class="keyword">while</span>(<span class="keyword">true</span>) &#123;  </div><div class="line"></div><div class="line"><span class="number">12</span>.                   System.out.println(<span class="string">"线程 "</span> + number + <span class="string">":计数 "</span> + count);  </div><div class="line"></div><div class="line"><span class="number">13</span>.                   <span class="keyword">if</span>(++count== <span class="number">6</span>) <span class="keyword">return</span>;  </div><div class="line"></div><div class="line"><span class="number">14</span>.             &#125;   </div><div class="line"></div><div class="line"><span class="number">15</span>.       &#125;  </div><div class="line"></div><div class="line"><span class="number">16</span>.   </div><div class="line"></div><div class="line"><span class="number">17</span>.       <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span> </span>&#123;  </div><div class="line"></div><div class="line"><span class="number">18</span>.             <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;  </div><div class="line"></div><div class="line"><span class="number">19</span>.                   <span class="keyword">new</span> Thread(<span class="keyword">new</span> MyThread(i+<span class="number">1</span>)).start();  </div><div class="line"></div><div class="line"><span class="number">20</span>.             &#125;   </div><div class="line"></div><div class="line"><span class="number">21</span>.       &#125;  </div><div class="line"></div><div class="line"><span class="number">22</span>.   </div><div class="line"></div><div class="line"><span class="number">23</span>. &#125;</div></pre></td></tr></table></figure>
<p>将我们希望线程执行的代码放到run方法中，然后通过start方法来启动线程，start方法首先为线程的执行准备好系统资源，然后再去调用run方法。当某个类继承了Thread类之后，该类就叫做一个线程类。 </p>
<h4 id="三、Thread源码研究："><a href="#三、Thread源码研究：" class="headerlink" title="三、Thread源码研究："></a>三、Thread源码研究：</h4><p>1) Thread类也实现了Runnable接口，因此实现了Runnable接口中的run方法；<br>2) 当生成一个线程对象时，如果没有为其设定名字，那么线程对象的名字将使用如下形式：Thread-number,该number将是自动增加的，并被所有的Thread对象所共享（因为它是static的成员变量）。<br>3) 当使用第一种方式来生成线程对象时，我们需要重写run方法，因为Thread类的run方法此时什么事情也不做。<br>4）当使用第二种方式生成线程对象时，我们需要实现Runnable接口的run方法，然后使用new Thread（new MyThread（））（假如MyThread已经实现了Runnable接口）来生成线程对象，这时的线程对象的run方法或调就会MyThread类的run方法，这样我们自己编写的run方法就执行了。<br>当使用继承Thread生成线程对象时，target为空，什么也不执行，当使用第二种方式生成时，执行target.run（），target为runnable的实例对象，即为执行重写后的方法<br>总结：两种生成线程对象的区别：<br>1.两种方法均需执行线程的start方法为线程分配必须的系统资源、调度线程运行并执行线程的run方法。<br>2.在具体应用中，采用哪种方法来构造线程体要视情况而定。通常，当一个线程已继承了另一个类时，就应该用第二种方法来构造，即实现Runnable接口。 </p>
<h4 id="三：线程的四种状态"><a href="#三：线程的四种状态" class="headerlink" title="三：线程的四种状态"></a>三：线程的四种状态</h4><ol>
<li>新状态：线程已被创建但尚未执行（start() 尚未被调用）。</li>
<li>可执行状态：线程可以执行，虽然不一定正在执行。CPU 时间随时可能被分配给该线程，从而使得它执行。</li>
<li>死亡状态：正常情况下 run() 返回使得线程死亡。调用 stop()或 destroy() 亦有同样效果，但是不被推荐，前者会产生异常，后者是强制终止，不会释放锁。</li>
<li>阻塞状态：线程不会被分配 CPU 时间，无法执行。</li>
</ol>
<h4 id="四：线程的优先级"><a href="#四：线程的优先级" class="headerlink" title="四：线程的优先级"></a>四：线程的优先级</h4><p>线程的优先级代表该线程的重要程度，当有多个线程同时处于可执行状态并等待获得 CPU 时间时，线程调度系统根据各个线程的优先级来决定给谁分配 CPU 时间，优先级高的线程有更大的机会获得 CPU 时间，优先级低的线程也不是没有机会，只是机会要小一些罢了。<br>你可以调用 Thread 类的方法 getPriority() 和 setPriority()来存取线程的优先级，线程的优先级界于1(MIN_PRIORITY)和10(MAX_PRIORITY)之间，缺省是5(NORM_PRIORITY)。</p>
<h4 id="五：线程的同步"><a href="#五：线程的同步" class="headerlink" title="五：线程的同步"></a>五：线程的同步</h4><p><a href="http://www.2cto.com/kf/201408/324061.html" target="_blank" rel="external">http://www.2cto.com/kf/201408/324061.html</a><br>由于同一进程的多个线程共享同一片存储空间，在带来方便的同时，也带来了访问冲突这个严重的问题。Java语言提供了专门机制以解决这种冲突，有效避免了同一个数据对象被多个线程同时访问。<br>由于我们可以通过 private 关键字来保证数据对象只能被方法访问，所以我们只需针对方法提出一套机制，这套机制就是 synchronized 关键字，它包括两种用法：synchronized 方法和 synchronized 块。</p>
<ol>
<li><p>synchronized 方法：通过在方法声明中加入 synchronized关键字来声明 synchronized 方法。如：</p>
<p>public synchronized void accessVal(int newVal);<br>synchronized 方法控制对类成员变量的访问：每个类实例对应一把锁，每个 synchronized 方法都必须获得调用该方法的类实例的锁方能执行，否则所属线程阻塞，方法一旦执行，就独占该锁，直到从该方法返回时才将锁释放，此后被阻塞的线程方能获得该锁，重新进入可执行状态。这种机制确保了同一时刻对于每一个类实例，其所有声明为 synchronized 的成员函数中至多只有一个处于可执行状态（因为至多只有一个能够获得该类实例对应的锁），从而有效避免了类成员变量的访问冲突（只要所有可能访问类成员变量的方法均被声明为 synchronized）。<br>在 Java 中，不光是类实例，每一个类也对应一把锁，这样我们也可将类的静态成员函数声明为 synchronized ，以控制其对类的静态成员变量的访问。<br>synchronized 方法的缺陷：若将一个大的方法声明为synchronized<br>将会大大影响效率，典型地，若将线程类的方法 run() 声明为 synchronized ，由于在线程的整个生命期内它一直在运行，因此将导致它对本类任何 synchronized 方法的调用都永远不会成功。当然我们可以通过将访问类成员变量的代码放到专门的方法中，将其声明为 synchronized ，并在主方法中调用来解决这一问题，但是 Java 为我们提供了更好的解决办法，那就是 synchronized 块。</p>
</li>
<li><p>synchronized 块：通过 synchronized关键字来声明synchronized 块。语法如下： </p>
</li>
</ol>
<p>synchronized(syncObject) {<br>  //允许访问控制的代码<br>}<br>synchronized 块是这样一个代码块，其中的代码必须获得对象 syncObject （如前所述，可以是类实例或类）的锁方能执行，具体机制同前所述。由于可以针对任意代码块，且可任意指定上锁的对象，故灵活性较高。</p>
<p>​     3.使用特殊域变量(volatile)实现线程同步</p>
<p>   a.volatile关键字为域变量的访问提供了一种免锁机制， </p>
<p>   b.使用volatile修饰域相当于告诉<a href="http://www.2cto.com/os/xuniji/" target="_blank" rel="external">虚拟机</a>该域可能会被其他线程更新， </p>
<p>   c.因此每次使用该域就要重新计算，而不是使用寄存器中的值 </p>
<p>   d.volatile不会提供任何原子操作，它也不能用来修饰final类型的变量 </p>
<p>   注：多线程中的非同步问题主要出现在对域的读写上，如果让域自身避免这个问题，则就不需要修改操作该域的方法。 </p>
<p>   用final域，有锁保护的域和volatile域可以避免非同步的问题。  </p>
<p>4.使用重入锁实现线程同步</p>
<p>   在<a href="http://www.2cto.com/kf/ware/Java/" target="_blank" rel="external">Java</a>SE5.0中新增了一个java.util.concurrent包来支持同步。 </p>
<p>   ReentrantLock类是可重入、互斥、实现了Lock接口的锁， </p>
<p>   它与使用synchronized方法和快具有相同的基本行为和语义，并且扩展了其能力</p>
<p>   ReenreantLock类的常用方法有：</p>
<p>   ReentrantLock() : 创建一个ReentrantLock实例 </p>
<pre><code>lock() : 获得锁 

unlock() : 释放锁 
</code></pre><p>   注：ReentrantLock()还有一个可以创建公平锁的构造方法，但由于能大幅度降低程序运行效率，不推荐使用 </p>
<p>   注：关于Lock对象和synchronized关键字的选择： </p>
<pre><code>a.最好两个都不用，使用一种java.util.concurrent包提供的机制， 

    能够帮助用户处理所有与锁相关的代码。 

b.如果synchronized关键字能满足用户的需求，就用synchronized，因为它能简化代码 

c.如果需要更高级的功能，就用ReentrantLock类，此时要注意及时释放锁，否则会出现死锁，通常在finally代码释放锁       
</code></pre><p>5.使用局部变量实现线程同步 </p>
<p>   如果使用ThreadLocal管理变量，则每一个使用该变量的线程都获得该变量的副本， </p>
<p>   副本之间相互独立，这样每一个线程都可以随意修改自己的变量副本，而不会对其他线程产生影响。</p>
<p> ThreadLocal 类的常用方法</p>
<p>   ThreadLocal() : 创建一个线程本地变量 </p>
<p>   get() : 返回此线程局部变量的当前线程副本中的值 </p>
<p>   initialValue() : 返回此线程局部变量的当前线程的”初始值” </p>
<p>   set(T value) : 将此线程局部变量的当前线程副本中的值设置为value</p>
<h5 id="ThreadLocal与同步机制"><a href="#ThreadLocal与同步机制" class="headerlink" title="ThreadLocal与同步机制"></a>ThreadLocal与同步机制</h5><pre><code>a.ThreadLocal与同步机制都是为了解决多线程中相同变量的访问冲突问题。 

b.前者采用以&quot;空间换时间&quot;的方法，后者采用以&quot;时间换空间&quot;的方式 
</code></pre><h4 id="六：线程的阻塞"><a href="#六：线程的阻塞" class="headerlink" title="六：线程的阻塞"></a>六：线程的阻塞</h4><p>为了解决对共享存储区的访问冲突，Java 引入了同步机制，现在让我们来考察多个线程对共享资源的访问，显然同步机制已经不够了，因为在任意时刻所要求的资源不一定已经准备好了被访问，反过来，同一时刻准备好了的资源也可能不止一个。为了解决这种情况下的访问控制问题，Java 引入了对阻塞机制的支持。<br>阻塞指的是暂停一个线程的执行以等待某个条件发生（如某资源就绪），学过操作系统的同学对它一定已经很熟悉了。Java 提供了大量方法来支持阻塞，下面让我们逐一分析。</p>
<ol>
<li>sleep() 方法：sleep() 允许 指定以毫秒为单位的一段时间作为参数，它使得线程在指定的时间内进入阻塞状态，不能得到CPU 时间，指定的时间一过，线程重新进入可执行状态。典型地，sleep() 被用在等待某个资源就绪的情形：<strong>测试</strong>发现条件不满足后，让线程阻塞一段时间后重新测试，直到条件满足为止。</li>
<li>suspend() 和 resume() 方法：两个方法配套使用，suspend()使得线程进入阻塞状态，并且不会自动恢复，必须其对应的resume() 被调用，才能使得线程重新进入可执行状态。典型地，suspend() 和 resume() 被用在等待另一个线程产生的结果的情形：测试发现结果还没有产生后，让线程阻塞，另一个线程产生了结果后，调用 resume() 使其恢复。</li>
<li>yield() 方法：yield() 使得线程放弃当前分得的 CPU 时间，但是不使线程阻塞，即线程仍处于可执行状态，随时可能再次分得 CPU 时间。调用 yield() 的效果等价于调度程序认为该线程已执行了足够的时间从而转到另一个线程。</li>
<li>wait() 和 notify() 方法：两个方法配套使用，wait() 使得线程进入阻塞状态，它有两种形式，一种允许 指定以毫秒为单位的一段时间作为参数，另一种没有参数，前者当对应的 notify() 被调用或者超出指定时间时线程重新进入可执行状态，后者则必须对应的 notify() 被调用。</li>
</ol>
<p>初看起来它们与 suspend() 和 resume() 方法对没有什么分别，但是事实上它们是截然不同的。区别的核心在于，前面叙述的所有方法，阻塞时都不会释放占用的锁（如果占用了的话），而这一对方法则相反。<br>上述的核心区别导致了一系列的细节上的区别。<br>首先，前面叙述的所有方法都隶属于 Thread 类，但是这一对却直接隶属于 Object 类，也就是说，所有对象都拥有这一对方法。初看起来这十分不可思议，但是实际上却是很自然的，因为这一对方法阻塞时要释放占用的锁，而锁是任何对象都具有的，调用任意对象的 wait() 方法导致线程阻塞，并且该对象上的锁被释放。而调用 任意对象的notify()方法则导致因调用该对象的 wait() 方法而阻塞的线程中随机选择的一个解除阻塞（但要等到获得锁后才真正可执行）。<br>其次，前面叙述的所有方法都可在任何位置调用，但是这一对方法却必须在 synchronized 方法或块中调用，理由也很简单，只有在synchronized 方法或块中当前线程才占有锁，才有锁可以释放。同样的道理，调用这一对方法的对象上的锁必须为当前线程所拥有，这样才有锁可以释放。因此，这一对方法调用必须放置在这样的 synchronized 方法或块中，该方法或块的上锁对象就是调用这一对方法的对象。若不满足这一条件，则程序虽然仍能编译，但在运行时会出现IllegalMonitorStateException 异常。<br>wait() 和 notify() 方法的上述特性决定了它们经常和synchronized 方法或块一起使用，将它们和操作系统的进程间通信机制作一个比较就会发现它们的相似性：synchronized方法或块提供了类似于操作系统原语的功能，它们的执行不会受到多线程机制的干扰，而这一对方法则相当于 block 和wakeup 原语（这一对方法均声明为 synchronized）。它们的结合使得我们可以实现操作系统上一系列精妙的进程间通信的<strong>算法</strong>（如信号量算法），并用于解决各种复杂的线程间通信问题。<br>关于 wait() 和 notify() 方法最后再说明两点：<br>第一：调用 notify() 方法导致解除阻塞的线程是从因调用该对象的 wait() 方法而阻塞的线程中随机选取的，我们无法预料哪一个线程将会被选择，所以编程时要特别小心，避免因这种不确定性而产生问题。<br>第二：除了 notify()，还有一个方法 notifyAll() 也可起到类似作用，唯一的区别在于，调用 notifyAll() 方法将把因调用该对象的 wait() 方法而阻塞的所有线程一次性全部解除阻塞。当然，只有获得锁的那一个线程才能进入可执行状态。<br>谈到阻塞，就不能不谈一谈死锁，略一分析就能发现，suspend() 方法和不指定超时期限的 wait() 方法的调用都可能产生死锁。遗憾的是，Java 并不在语言级别上支持死锁的避免，我们在编程中必须小心地避免死锁。<br>以上我们对 Java 中实现线程阻塞的各种方法作了一番分析，我们重点分析了 wait() 和 notify() 方法，因为它们的功能最强大，使用也最灵活，但是这也导致了它们的效率较低，较容易出错。实际使用中我们应该灵活使用各种方法，以便更好地达到我们的目的。</p>
<p>生产者消费者模型</p>
<p><a href="http://blog.csdn.net/zhangyuan19880606/article/details/51153035" target="_blank" rel="external">http://blog.csdn.net/zhangyuan19880606/article/details/51153035</a></p>
<p>一种重要的模型，基于等待/通知机制。生产者/消费者模型描述的是有一块缓冲区作为仓库，生产者可将产品放入仓库，消费者可以从仓库中取出产品，生产者/消费者模型关注的是以下几个点：</p>
<p>1、生产者生产的时候消费者不能消费</p>
<p>2、消费者消费的时候生产者不能生产</p>
<p>3、缓冲区空时消费者不能消费</p>
<p>4、缓冲区满时生产者不能生产</p>
<p>生产者/模型作为一种重要的模型，它的优点在于：</p>
<p>1、解耦。因为多了一个缓冲区，所以生产者和消费者并不直接相互调用，这一点很容易想到，这样生产者和消费者的代码发生变化，都不会对对方产生影响，这样其实就把生产者和消费者之间的强耦合解开，变为了生产者和缓冲区/消费者和缓冲区之间的弱耦合</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">** </div><div class="line"> * 公共资源类 </div><div class="line"> */  </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PublicResource</span> </span>&#123;  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> number = <span class="number">0</span>;  </div><div class="line">  </div><div class="line">    <span class="comment">/** </span></div><div class="line">     * 增加公共资源 </div><div class="line">     */  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">increace</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="keyword">while</span> (number != <span class="number">0</span>) &#123;  </div><div class="line">            <span class="keyword">try</span> &#123;  </div><div class="line">                wait();  </div><div class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;  </div><div class="line">                e.printStackTrace();  </div><div class="line">            &#125;  </div><div class="line">        &#125;  </div><div class="line">        number++;  </div><div class="line">        System.out.println(number);  </div><div class="line">        notify();  </div><div class="line">    &#125;  </div><div class="line">  </div><div class="line">    <span class="comment">/** </span></div><div class="line">     * 减少公共资源 </div><div class="line">     */  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">decreace</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="keyword">while</span> (number == <span class="number">0</span>) &#123;  </div><div class="line">            <span class="keyword">try</span> &#123;  </div><div class="line">                wait();  </div><div class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;  </div><div class="line">                e.printStackTrace();  </div><div class="line">            &#125;  </div><div class="line">        &#125;  </div><div class="line">        number--;  </div><div class="line">        System.out.println(number);  </div><div class="line">        notify();  </div><div class="line">    &#125;  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>二，分别定义生产者线程和消费者线程，并模拟多次生产和消费，即增加和减少公共资源的number值</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/** </span></div><div class="line"> * 生产者线程，负责生产公共资源 </div><div class="line"> */  </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProducerThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;  </div><div class="line">    <span class="keyword">private</span> PublicResource resource;  </div><div class="line">  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ProducerThread</span><span class="params">(PublicResource resource)</span> </span>&#123;  </div><div class="line">        <span class="keyword">this</span>.resource = resource;  </div><div class="line">    &#125;  </div><div class="line">  </div><div class="line">    <span class="meta">@Override</span>  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;  </div><div class="line">            <span class="keyword">try</span> &#123;  </div><div class="line">                Thread.sleep((<span class="keyword">long</span>) (Math.random() * <span class="number">1000</span>));  </div><div class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;  </div><div class="line">                e.printStackTrace();  </div><div class="line">            &#125;  </div><div class="line">            resource.increace();  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line">&#125;  </div><div class="line"><span class="comment">/** </span></div><div class="line"> * 消费者线程，负责消费公共资源 </div><div class="line"> */  </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConsumerThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;  </div><div class="line">    <span class="keyword">private</span> PublicResource resource;  </div><div class="line">  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConsumerThread</span><span class="params">(PublicResource resource)</span> </span>&#123;  </div><div class="line">        <span class="keyword">this</span>.resource = resource;  </div><div class="line">    &#125;  </div><div class="line">  </div><div class="line">    <span class="meta">@Override</span>  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;  </div><div class="line">            <span class="keyword">try</span> &#123;  </div><div class="line">                Thread.sleep((<span class="keyword">long</span>) (Math.random() * <span class="number">1000</span>));  </div><div class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;  </div><div class="line">                e.printStackTrace();  </div><div class="line">            &#125;  </div><div class="line">            resource.decreace();  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>三，模拟多个生产者和消费者操作公共资源的情形，结果须保证是在允许的范围内。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProducerConsumerTest</span> </span>&#123;  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;  </div><div class="line">        PublicResource resource = <span class="keyword">new</span> PublicResource();  </div><div class="line">        <span class="keyword">new</span> Thread(<span class="keyword">new</span> ProducerThread(resource)).start();  </div><div class="line">        <span class="keyword">new</span> Thread(<span class="keyword">new</span> ConsumerThread(resource)).start();  </div><div class="line">        <span class="keyword">new</span> Thread(<span class="keyword">new</span> ProducerThread(resource)).start();  </div><div class="line">        <span class="keyword">new</span> Thread(<span class="keyword">new</span> ConsumerThread(resource)).start();  </div><div class="line">        <span class="keyword">new</span> Thread(<span class="keyword">new</span> ProducerThread(resource)).start();  </div><div class="line">        <span class="keyword">new</span> Thread(<span class="keyword">new</span> ConsumerThread(resource)).start();  </div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>生产数据和消费数据一定是成对出现的，生产一个消费一个，满了不生产，空了不消费，生产者不能无限生产，消费者也不能无限消费，符合生产者/消费者模型。生产者速度快，就不占用CPU时间片，等着消费者消费完通知它继续生产，这块时间片可以用来给其他线程用。</p>
<h4 id="七：守护线程"><a href="#七：守护线程" class="headerlink" title="七：守护线程"></a>七：守护线程</h4><p>守护线程是一类特殊的线程，它和普通线程的区别在于它并不是应用程序的核心部分，当一个应用程序的所有非守护线程终止运行时，即使仍然有守护线程在运行，应用程序也将终止，反之，只要有一个非守护线程在运行，应用程序就不会终止。守护线程一般被用于在后台为其它线程提供服务。</p>
<p>可以通过调用方法 isDaemon() 来判断一个线程是否是守护线程，也可以调用方法 setDaemon() 来将一个线程设为守护线程。</p>
<p>死锁：<strong>产生死锁的四个必要条件：</strong></p>
<p>（1） 互斥条件：一个资源每次只能被一个进程使用。<br>（2） 请求与保持条件：一个进程因请求资源而阻塞时，对已获得的资源保持不放。<br>（3） 不剥夺条件:进程已获得的资源，在末使用完之前，不能强行剥夺。<br>（4） 循环等待条件:若干进程之间形成一种头尾相接的循环等待资源关系。</p>
<p>锁的类别有两种分法：  </p>
<ol>
<li>从数据库系统的角度来看：分为独占锁（即排它锁），共享锁和更新锁  </li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line">1.	&lt;span style="font-size:18px;"&gt;class Test implements Runnable  </div><div class="line">2.	&#123;  </div><div class="line">3.	    private boolean flag; //flag标签，让t1和t2线程执行不同代码  </div><div class="line">4.	    public Test(boolean flag)  </div><div class="line">5.	    &#123;  </div><div class="line">6.	        this.flag=flag;  </div><div class="line">7.	    &#125;  </div><div class="line">8.	    public void run()  </div><div class="line">9.	    &#123;  </div><div class="line">10.	        if (flag)    </div><div class="line">11.	        &#123;  </div><div class="line">12.	            synchronized(MyLock.lock1)  </div><div class="line">13.	            &#123;  </div><div class="line">14.	                System.out.println("if1");  </div><div class="line">15.	  </div><div class="line">16.	                synchronized(MyLock.lock2)  </div><div class="line">17.	                &#123;  </div><div class="line">18.	                System.out.println("if2");  </div><div class="line">19.	                &#125;  </div><div class="line">20.	            &#125;  </div><div class="line">21.	        &#125;  </div><div class="line">22.	        else  </div><div class="line">23.	        &#123;  </div><div class="line">24.	            synchronized(MyLock.lock2)  </div><div class="line">25.	            &#123;  </div><div class="line">26.	                System.out.println("else2");  </div><div class="line">27.	  </div><div class="line">28.	                synchronized(MyLock.lock1)  </div><div class="line">29.	                &#123;  </div><div class="line">30.	                System.out.println("else1");  </div><div class="line">31.	                &#125;  </div><div class="line">32.	            &#125;  </div><div class="line">33.	        &#125;  </div><div class="line">34.	      </div><div class="line">35.	    &#125;  </div><div class="line">36.	  </div><div class="line">37.	      </div><div class="line">38.	&#125;  </div><div class="line">39.	  </div><div class="line">40.	class MyLock  //两个锁，用来制造死锁  </div><div class="line">41.	&#123;  </div><div class="line">42.	    public static Object lock1 = new Object();  </div><div class="line">43.	    public static Object lock2 = new Object();  </div><div class="line">44.	  </div><div class="line">45.	&#125;  </div><div class="line">46.	  </div><div class="line">47.	class DeadLock   </div><div class="line">48.	&#123;  </div><div class="line">49.	    public static void main(String[] args)   </div><div class="line">50.	    &#123;   </div><div class="line">51.	        Thread t1 = new Thread(new Test(true)); //t1先用锁1再用锁2  </div><div class="line">52.	        Thread t2 = new Thread(new Test(false));//t2先用锁2再用锁1  </div><div class="line">53.	          </div><div class="line">54.	        t1.start();  </div><div class="line">55.	        t2.start();  </div><div class="line">56.	          </div><div class="line">57.	    &#125;  </div><div class="line">58.	&#125;  </div><div class="line">59.	&lt;/span&gt;</div></pre></td></tr></table></figure>

      

      
        <div class="page-reward">
          <a href="javascript:;" class="page-reward-btn tooltip-top">
            <div class="tooltip tooltip-east">
            <span class="tooltip-item">
              赏
            </span>
            <span class="tooltip-content">
              <span class="tooltip-text">
                <span class="tooltip-inner">
                  <p class="reward-p"><i class="icon icon-quo-left"></i>谢谢你请我吃糖果<i class="icon icon-quo-right"></i></p>
                  <div class="reward-box">
                    
                    
                  </div>
                </span>
              </span>
            </span>
          </div>
          </a>
        </div>
      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/">java</a></li></ul>
	</div>

      

      

      
        
<div class="share-btn share-icons tooltip-left">
  <div class="tooltip tooltip-east">
    <span class="tooltip-item">
      <a href="javascript:;" class="share-sns share-outer">
        <i class="icon icon-share"></i>
      </a>
    </span>
    <span class="tooltip-content">
      <div class="share-wrap">
        <div class="share-icons">
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="icon icon-weibo"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="icon icon-weixin"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="icon icon-qq"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="icon icon-douban"></i>
          </a>
          <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a>
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="icon icon-facebook"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="icon icon-twitter"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="icon icon-google"></i>
          </a>
        </div>
      </div>
    </span>
  </div>
</div>

<div class="page-modal wx-share js-wx-box">
    <a class="close js-modal-close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="http://s.jiathis.com/qrcode.php?url=http://yoursite.com/2016/12/10/multithreading/" alt="微信分享二维码">
    </div>
</div>

<div class="mask js-mask"></div>
      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

  
<nav id="article-nav">
  
    <a href="/2016/12/11/java1/" id="article-nav-newer" class="article-nav-link-wrap">
      <i class="icon-circle-left"></i>
      <div class="article-nav-title">
        
          java基础整理
        
      </div>
    </a>
  
  
    <a href="/2016/12/10/first/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">first</div>
      <i class="icon-circle-right"></i>
    </a>
  
</nav>






<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="multithreading" data-title="multithreading" data-url="http://yoursite.com/2016/12/10/multithreading/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
    var duoshuoQuery = {short_name:"caroltuan"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>





          </div>
        </div>
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 caroltuan
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		mathjax: false,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		root: "/",
		innerArchive: true
	}
</script>

<script src="/./main.js?v=4.0.0.js"></script>


    
<div class="tools-col" q-class="show:isShow,hide:isShow|isFalse" q-on="click:stop(e)">
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all" q-show="innerArchive">
        <div class="search-wrap">
          <input class="search-ipt" q-model="search" type="text" placeholder="find something…">
          <i class="icon-search icon" q-show="search|isEmptyStr"></i>
          <i class="icon-close icon" q-show="search|isNotEmptyStr" q-on="click:clearChose(e)"></i>
        </div>
        <div class="widget tagcloud search-tag">
          <p class="search-tag-wording">tag:</p>
          <label class="search-switch">
            <input type="checkbox" q-on="click:toggleTag(e)" q-attr="checked:showTags">
          </label>
          <ul class="article-tag-list" q-show="showTags">
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">JDBC</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">ajax</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">learning</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">json</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">javaoop</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">jsp servlet</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">java</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">throwable</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">多线程</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">API</a>
              </li>
            
            <div class="clearfix"></div>
          </ul>
        </div>
        <ul class="search-ul">
          <p q-show="jsonFail" style="padding: 20px; font-size: 12px;">
            缺失模块。<br/>1、在博客根目录（注意不是yilia根目录）执行以下命令：<br/> npm i hexo-generator-json-content --save<br/><br/>
            2、在根目录_config.yml里添加配置：
<pre style="font-size: 12px;" q-show="jsonFail">
  jsonContent:
    meta: false
    pages: false
    posts:
      title: true
      date: true
      path: true
      text: true
      raw: false
      content: false
      slug: false
      updated: false
      comments: false
      link: false
      permalink: false
      excerpt: false
      categories: false
      tags: true
</pre>
          </p>
          <li class="search-li" q-repeat="items" q-show="isShow">
            <a q-attr="href:path|urlformat" class="search-title"><i class="icon-quo-left icon"></i><span q-text="title"></span></a>
            <p class="search-time">
              <i class="icon-calendar icon"></i>
              <span q-text="date|dateformat"></span>
            </p>
            <p class="search-tag">
              <i class="icon-price-tags icon"></i>
              <span q-repeat="tags" q-on="click:choseTag(e, name)" q-text="name|tagformat"></span>
            </p>
          </li>
        </ul>
    	</section>
    

    
    	<section class="tools-section tools-section-friends" q-show="friends">
  		
        <ul class="search-ul">
          
            <li class="search-li">
              <a href="http://shinerio.cc" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>自恋瑞的blog</a>
            </li>
          
        </ul>
  		
    	</section>
    

    
    	<section class="tools-section tools-section-me" q-show="aboutme">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">一只团&lt;br&gt;&lt;br&gt;一只想要认真学习的团</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>